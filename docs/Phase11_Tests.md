# Этап 11 — Unit-тесты (сборка 100%)

## Цель этапа

Обеспечение качества кода и надежности бизнес-логики приложения через автоматизированное тестирование. Создание тестового проекта, настройка окружения и написание тестов для ключевых компонентов системы.

## Файлы (создать/изменить)

1.  **ClinicApp.Tests/ClinicApp.Tests.csproj** — Новый проект тестов (xUnit).
2.  **ClinicApp.Tests/DomainTests.cs** — Тесты для сущностей предметной области (Patient, User, Appointment).
3.  **ClinicApp.Tests/AuthServiceTests.cs** — Тесты для сервиса авторизации с использованием InMemory базы данных.

## Технологический стек

*   **xUnit:** Фреймворк для написания и запуска тестов.
*   **Moq:** Библиотека для создания заглушек (Mocks) зависимостей.
*   **EF Core InMemory:** Провайдер базы данных в памяти для тестирования репозиториев и сервисов без реальной БД.

## Реализованные тесты (7 тестов)

1.  **Patient_FullName_ShouldReturnCorrectFormat:** Проверка корректности формирования полного имени пациента.
2.  **User_FullName_ShouldReturnCorrectValue:** Проверка свойства FullName у пользователя.
3.  **Appointment_DefaultStatus_ShouldNotBeCancelled:** Проверка статуса записи по умолчанию.
4.  **LoginAsync_WithCorrectCredentials_ShouldReturnTrue:** Успешный вход в систему.
5.  **LoginAsync_WithWrongPassword_ShouldReturnFalse:** Отказ в доступе при неверном пароле.
6.  **IsInRole_ShouldReturnTrueForAdmin:** Проверка корректности определения роли администратора.
7.  **IsInRole_ShouldReturnFalseForDoctor:** Проверка отсутствия роли врача у администратора.

## Действия в Visual Studio

1.  Открыть `ClinicApp.sln`.
2.  Открыть окно "Обозреватель тестов" (Test Explorer).
3.  Нажать "Запустить все тесты" (Run All Tests).
4.  Убедиться, что все 7 тестов пройдены успешно (зеленые галочки).

## Проверка работоспособности

1.  **Build succeeded:** Решение и проект тестов собираются без ошибок.
2.  **Tests passed:** Все тесты выполняются успешно (`total: 7, failed: 0, succeeded: 7`).

## Завершение проекта

Все этапы (0–11) выполнены. Проект готов к финальной сдаче.
