# Этап 8 — Reports + экспорт CSV (сборка 100%)

## Цель этапа

Реализация функционала формирования отчетов и экспорта данных. Создание сервиса для генерации CSV-файлов, разработка интерфейса управления отчетами и интеграция с существующими репозиториями для получения актуальных данных.

## Файлы (создать/изменить)

1.  **ClinicApp.Application/Interfaces/IReportService.cs** — Интерфейс сервиса отчетов.
2.  **ClinicApp.Infrastructure/Data/Repositories/ReportService.cs** — Реализация сервиса (генерация CSV).
3.  **ClinicApp.Wpf/ViewModels/ReportsViewModel.cs** — ViewModel для управления экспортом.
4.  **ClinicApp.Wpf/Views/ReportsView.xaml** — Интерфейс раздела отчетов.
5.  **ClinicApp.Wpf/ViewModels/MainViewModel.cs** — Обновление: навигация к отчетам.
6.  **ClinicApp.Wpf/MainWindow.xaml** — Обновление: кнопка "Отчеты" (доступна только Admin).
7.  **ClinicApp.Wpf/App.xaml.cs** — Обновление: регистрация сервиса и ViewModel в DI.

## Реализованные отчеты

1.  **Отчет по приемам:** Экспортирует все записи (ID, Пациент, Врач, Время, Статус, Заметки).
2.  **Отчет по пациентам:** Экспортирует список пациентов (ID, ФИО, Телефон, Дата рождения).

## Логика экспорта

*   Данные извлекаются из соответствующих репозиториев.
*   Формируется строка в формате CSV (разделитель `;`).
*   Используется стандартное диалоговое окно `SaveFileDialog` для выбора места сохранения файла.
*   Кодировка файла — UTF-8.

## Действия в Visual Studio

1.  Открыть `ClinicApp.sln`.
2.  Нажать `Ctrl+Shift+B` для сборки.
3.  Нажать `F5` для запуска.
4.  Войти под учетной записью `admin`.
5.  Перейти в раздел "Отчеты" и нажать "Экспорт CSV". Выбрать путь для сохранения.

## Проверка работоспособности

1.  **Build succeeded:** Решение собирается без ошибок.
2.  **Export:** После нажатия кнопки открывается диалог сохранения, и файл создается с корректным содержимым.
3.  **Roles:** Раздел "Отчеты" виден только пользователю с ролью `Admin`.

## Переход к следующему этапу

Сборка гарантирована (Build Succeeded). Переходим к Этапу 9 — UI MaterialDesignThemes.
